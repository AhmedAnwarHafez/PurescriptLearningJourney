"use strict";
var Ch6 = require("../Ch6/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Data_Array = require("../Data.Array/index.js");
var Data_Either = require("../Data.Either/index.js");
var Data_Show = require("../Data.Show/index.js");
var Data_String_CodeUnits = require("../Data.String.CodeUnits/index.js");
var validateUsername$prime = function (v) {
    return Control_Bind.bind(Data_Either.bindEither)(Ch6.cleanWhitespace(v))(function (v1) {
        return Control_Bind.bind(Data_Either.bindEither)(Ch6.requireAlphaNum(v1))(function (v2) {
            return Ch6.checkUsernameLength(v2);
        });
    });
};
var validateUsername = function (v) {
    return Control_Bind.bind(Data_Either.bindEither)(Control_Bind.bind(Data_Either.bindEither)(Ch6.cleanWhitespace(v))(Ch6.requireAlphaNum))(Ch6.checkUsernameLength);
};
var checkLength = function (maxLength) {
    return function (s) {
        var v = Data_Array.length(Data_String_CodeUnits.toCharArray(s)) > maxLength;
        if (v) {
            return Data_Either.Left.create(Ch6["Error"]("Cannot exceed " + Data_Show.show(Data_Show.showInt)(maxLength)));
        };
        if (!v) {
            return new Data_Either.Right(s);
        };
        throw new Error("Failed pattern match at Ch6e (line 20, column 5 - line 22, column 27): " + [ v.constructor.name ]);
    };
};
module.exports = {
    validateUsername: validateUsername,
    checkLength: checkLength,
    "validateUsername'": validateUsername$prime
};
